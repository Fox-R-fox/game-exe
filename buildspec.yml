version: 0.2

phases:
  install:
    commands:
      - echo Installing dependencies...
      - python -m pip install --upgrade pip
      - if command -v apt-get >/dev/null; then sudo apt-get install -y python3-tk; fi  # Debian/Ubuntu
      - if command -v yum >/dev/null; then sudo yum install -y python3-tkinter; fi  # Red Hat/CentOS
      - if command -v dnf >/dev/null; then sudo dnf install -y python3-tkinter; fi  # Fedora
      - pip install -r requirements.txt
      - pip install pyinstaller  # Ensure pyinstaller is installed

  build:
    commands:
      - echo Building the executable...
      - pyinstaller --onefile ui.py

  post_build:
    commands:
      - echo Build complete
      - echo Creating a folder for the executable...
      - mkdir dist\flappybird
      - echo Moving the executable to the folder...
      - move dist\ui.exe dist\flappybird\
      - echo Listing the contents of the folder...
      - dir dist\flappybird
      - echo Zipping the folder...
      - powershell Compress-Archive -Path dist\flappybird -DestinationPath dist\flappybird-executable.zip
      - echo Copying the zipped folder to the S3 bucket...
      - aws s3 cp dist\flappybird-executable.zip s3://builddb/flappybird-executable.zip
